<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <title>1世帯負担金試算</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 1rem;
            background-color: #ffffff;
        }
        label, h3, p {
            margin: 10px 0;
        }
    </style>
    <script>
        function calculate() {
            // 送料の定義
            var shippingCosts = {
                'low': 2750,
                'high': 3300
            };

            // サイズごとの基本価格と対応する送料の種類
            var sizes = {
                'ミニミニ': { price: 34100, shipping: 'low' },
                'ミニ': { price: 35750, shipping: 'low' },
                '小': { price: 36850, shipping: 'low' },
                '中': { price: 52580, shipping: 'high' },
                'マンション': { price: 53680, shipping: 'high' },
                '大': { price: 54780, shipping: 'high' }
            };

            var selectedSize = document.getElementById('size').value;
            var households = parseInt(document.getElementById('households').value);
            var nonMemberHouseholds = parseInt(document.getElementById('nonMemberHouseholds').value);
            var subsidy = 1200;

            if (sizes[selectedSize] && !isNaN(households) && households > 0 && !isNaN(nonMemberHouseholds) && nonMemberHouseholds >= 0) {
                var memberHouseholds = households - nonMemberHouseholds;
                var totalCost = sizes[selectedSize].price + shippingCosts[sizes[selectedSize].shipping];
                var perHousehold = totalCost / households;

                // 未加入世帯がある場合、補助金を他の加入世帯で負担
                var adjustedSubsidy = subsidy * (households / memberHouseholds);
                var finalAmount = perHousehold - adjustedSubsidy;

                // 小数点以下を表示しないように Math.floor() を使用
                document.getElementById('resultA').innerText = Math.floor(perHousehold) + '円';
                document.getElementById('resultB').innerText = Math.floor(finalAmount) + '円';
            } else {
                document.getElementById('resultA').innerText = 'N/A';
                document.getElementById('resultB').innerText = 'N/A';
            }
        }
    </script>
</head>
<body>
    <h2 class="title is-3">1世帯負担金試算</h2>
    <form oninput="calculate()">
        <label for="size">希望サイズ:</label>
        <div class="select is-rounded">
        <select id="size" name="size">
            <option value="">選択してください</option>
            <option value="ミニミニ">ミニミニ（34,100円 + 2,750円 送料）</option>
            <option value="ミニ">ミニ（35,750円 + 2,750円 送料）</option>
            <option value="小">小（36,850円 + 2,750円 送料）</option>
            <option value="中">中（52,580円 + 3,300円 送料）</option>
            <option value="マンション">マンション（53,680円 + 3,300円 送料）</option>
            <option value="大">大（54,780円 + 3,300円 送料）</option>
        </select></div>
        <br><br>

        <label for="households">参加世帯数:</label>
        <input type="number" id="households" name="households" class="input" placeholder="例）20">

        <label for="nonMemberHouseholds">自治会未加入世帯数:</label>
        <input type="number" id="nonMemberHouseholds" name="nonMemberHouseholds" class="input" placeholder="例）2">
        <hr />
       
        <h3 class="title is-4">計算結果</h3>
        <p><span id="resultA">N/A</span> /世帯</p>
        <p>※自治会補助金（1,200円）差し引き後</p>
        <div class="box">
        <p>入会1世帯負担金: <span id="resultB" class="subtitle is-3">N/A</span></p>
        <p><small>※自治会に未加入の世帯がある場合、その分の補助金を他の加入世帯が負担します</small></p>
        </div>
    </form>
</body>
</html>
